!function(){var e,t,a,s,n,r,o={52686:function(e,t,a){"use strict";a.d(t,{A0:function(){return R},AB:function(){return Z},Bm:function(){return M},Dr:function(){return g},E1:function(){return ec},GS:function(){return m},Ge:function(){return s},IH:function(){return z},Ix:function(){return Y},K4:function(){return N},KS:function(){return eg},KW:function(){return I},L8:function(){return L},Lj:function(){return ef},Md:function(){return c},P1:function(){return ea},P3:function(){return q},Rf:function(){return K},S1:function(){return F},Sj:function(){return G},TT:function(){return _},TU:function(){return eh},U8:function(){return B},UB:function(){return n},UH:function(){return i},VE:function(){return T},VN:function(){return er},WG:function(){return W},WK:function(){return u},WQ:function(){return H},XS:function(){return C},XX:function(){return et},Xb:function(){return eA},Xf:function(){return j},Xx:function(){return Q},YM:function(){return $},Zs:function(){return b},aC:function(){return E},c:function(){return O},eM:function(){return l},fC:function(){return h},g4:function(){return D},hk:function(){return A},lI:function(){return v},lV:function(){return X},oU:function(){return P},om:function(){return p},pF:function(){return f},qq:function(){return o},s3:function(){return y},sL:function(){return es},sy:function(){return U},ty:function(){return eE},v2:function(){return r},vn:function(){return d},x1:function(){return en},x8:function(){return ee},yo:function(){return V},z8:function(){return J}});let s=6,n=[11789,11790,11791,11792,11793,11794,11795,11796],r=[11778,11779,11780],o=[11719],i=[11721],c=[11730,11732,11733],l=[11750,11751,11752],u=[11753,11754,11756,11757],h=[11761,11763,11762,11764],f=[11755,11758],d=[...n,11797,11798,11799,...r,...o,...i,11724,11725,11726,...c],g=[...d,...l,...u,...f,...h],m=[10830,10831,10832,8369,8370,8371,10847,10848,10849],p=[...m,10833,10834,10835,8372,8373,8374,10850,10851,10852],A=[8387,8388,10867,10868],E=[...m,8360,8361,8362,8363,8364,8365,8366,8367,8359,8342,8343,8344,8345,8346,8347,8348,8349,8350,8351,8352,8353,8355,8356,8357,...A,8339,8340,8372,8373,8374,8376,8381,8382,8383,8384,8385,10822,10823,10824,10825,10826,10827,10828,10829,10813,10791,10792,10793,10794,10795,10796,10797,10798,10799,10800,10801,10802,10804,10805,10806,10808,10809,10810,10770,10771,10772,10850,10851,10852,10854,10858,10859,10860,10861,10862],y=[10814,10815,10816,10817,10818,10819,10820,10821,10812,10774,10775,10776,10777,10778,10779,10780,10781,10782,10783,10784,10785,10787,10788,10789,10864,10865,10767,10768,10833,10834,10835,10837,10841,10842,10843,10844,10845],L=[7540,7543,7544,7545],_=[7569,7571,7570,7572],M=[7551,7554],b=[7552,7555],D=[7550,7553],R=[...M,...b,...D],k=[7533],P=[7568],S=[7538,7539],C=[7559,...L,...k,7530,7531,7532,...S,...b,...D],T=[7548,7549,...S],v=[378,9425,9426,9427,9428,9429,9430,9431,9432,9433,9460,377,9423,9416,9417,9418,9419,9420,9421,9422,9424,11153,11154,11155],N=[9434,9437,9440,9443,9435,9438,9441,9444],F=[11278,11279,11280,11281,11282],O=[7584,7585,...p,8917,8918,8919,8920,11709,11712,9118],x=[7851,7854,7855,7882,7883,7886,7887,7888,7889],w=[2463,2465,2467,2464,2466,2468,2137,2138,2139,2140,2141,2142],I=[2042,2043,2044],H=[494,...k,7706,7708,12214,12215,12219,7852,7853,7884,7885,...I],B=[3169,3170,3171,3172,3173,3174,3175,3176,3177,3178,3179,3180,3181,3182,3183,7037],U=[...L,...x,...P,...w],Y=[...L,...x,...P,...w],W=[...x,...w];[...g,...E,...y];let G=[1667,5739,5740,5741,5742,5743,5744,5745,5746,5747,1668,5757,5758,5759,5760,5761,5762,5763,5764,5765],V=[12223,12224,12228,12425,12426,13656],Z=[12596,14147],K=[14150,14151],X=[7796],j=[14179],z=3,q=["Autocast","Defensive Autocast","Manual Cast"],J=[7223,8584,11193,11781],Q={melee:[11710,11713,12814,...f,...j],ranged:[11711,11714,12815,11717,11715,...j],magic:[11709,11712,12816,14151,14150,...j]},$=[5916],ee=[931,4135,7691,12335],et=4,ea=.6,es=1e3,en=1e-4,er={5947:10,5961:10},eo={},ei=["Shielded","Shielded (Defenceless)","Unshielded"];[13599,13600,13601,13602,13603,13604,13605,13606].forEach(e=>{eo[e]=ei});let ec=[13668],el=["Standard","Enraged"];ec.forEach(e=>{eo[e]=el});let eu=[14009,14010,14013],eh=[14014],ef=[...eu,14017,...eh],ed=["Without Pillar","With Pillar"],eg=[...eu,...eh];eg.forEach(e=>{eo[e]=ed});let em=["In Melee Range","Out of Melee Range"];Z.forEach(e=>{eo[e]=em});let ep=["Standard","Transition"],eA=[5886,5889,5891];eA.forEach(e=>{eo[e]=ep});let eE=[14176],ey=["Tank using magic","Tank not using magic"];eE.forEach(e=>{eo[e]=ey})},7237:function(e,t,a){"use strict";a.d(t,{$K:function(){return v},CR:function(){return O},EK:function(){return x},XP:function(){return N},Xy:function(){return F},iK:function(){return n}});var s,n,r=a(97431),o=a(61820),i=a(81593),c=a(11960),l=a(43557),u=a(68491),h=a(49433),f=a(19105),d=a(99817),g=a(88631),m=a(17163),p=a(85248),A=a(73642),E=a(81236),y=a(53083),L=a(26953),_=a(93102),M=a(69492),b=a(22923),D=a(83868),R=a(59437),k=a(84189),P=a(6675),S=a(45657),C=a(30217),T=a.n(C);function v(e){return!!e}(s=n||(n={}))[s.IMPLEMENTED=0]="IMPLEMENTED",s[s.PARTIALLY_IMPLEMENTED=1]="PARTIALLY_IMPLEMENTED",s[s.UNIMPLEMENTED=2]="UNIMPLEMENTED",s[s.NOT_APPLICABLE=3]="NOT_APPLICABLE";let N=e=>Object.keys(e),F=(e,t)=>T()({},e,t);class O{resolve(e){this._resolve(e)}reject(e){this._reject(e)}constructor(){(0,r._)(this,"_resolve",void 0),(0,r._)(this,"_reject",void 0),(0,r._)(this,"promise",void 0),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}P.Z.OVERLOAD_PLUS,h.default,P.Z.SMELLING_SALTS,g.default,P.Z.SUPER_COMBAT,y.default,P.Z.RANGING,f.default,P.Z.SATURATED_HEART,d.default,P.Z.IMBUED_HEART,l.default,P.Z.FORGOTTEN_BREW,c.default,P.Z.SUPER_ATTACK,p.default,P.Z.SUPER_STRENGTH,A.default,P.Z.ANCIENT,o.default,P.Z.OVERLOAD,h.default,P.Z.MAGIC,u.default,P.Z.ATTACK,i.default,P.Z.STRENGTH,m.default,P.Z.SUPER_RANGING,E.default,P.Z.SUPER_MAGIC,L.default,P.Z.DEFENCE,_.default,P.Z.SUPER_DEFENCE,M.default,P.Z.RUBY_HARVEST,D.default,P.Z.BLACK_WARLOCK,R.default,P.Z.SAPPHIRE_GLACIALIS,k.default,P.Z.MOONLIGHT,b.default,S.F.BLASTER,S.F.GUN,S.F.AXE,S.F.TWO_HANDED_SWORD,S.F.PARTISAN,S.F.SLASH_SWORD,S.F.STAB_SWORD,S.F.BANNER,S.F.SPEAR,S.F.SPIKED,S.F.UNARMED,S.F.STAFF,S.F.BLADED_STAFF,S.F.POLESTAFF,S.F.BLUDGEON,S.F.BLUNT,S.F.BULWARK,S.F.CROSSBOW,S.F.SCYTHE,S.F.POWERED_STAFF,S.F.POWERED_WAND,S.F.THROWN,S.F.BOW,S.F.PICKAXE,S.F.CLAW,S.F.CHINCHOMPA,S.F.POLEARM,S.F.WHIP,S.F.SALAMANDER,S.F.DAGGER,S.F.NONE;let x=e=>{let t=[];switch(e){case S.F.TWO_HANDED_SWORD:t=[{name:"Chop",type:"slash",stance:"Accurate"},{name:"Slash",type:"slash",stance:"Aggressive"},{name:"Smash",type:"crush",stance:"Aggressive"},{name:"Block",type:"slash",stance:"Defensive"}];break;case S.F.BANNER:t=[{name:"Lunge",type:"stab",stance:"Accurate"},{name:"Swipe",type:"slash",stance:"Aggressive"},{name:"Pound",type:"crush",stance:"Controlled"},{name:"Block",type:"stab",stance:"Defensive"}];break;case S.F.BLADED_STAFF:t=[{name:"Jab",type:"stab",stance:"Accurate"},{name:"Swipe",type:"slash",stance:"Aggressive"},{name:"Fend",type:"crush",stance:"Defensive"},{name:"Spell",type:"magic",stance:"Defensive Autocast"},{name:"Spell",type:"magic",stance:"Autocast"}];break;case S.F.BLASTER:return[];case S.F.BOW:case S.F.CROSSBOW:case S.F.THROWN:t=[{name:"Accurate",type:"ranged",stance:"Accurate"},{name:"Rapid",type:"ranged",stance:"Rapid"},{name:"Longrange",type:"ranged",stance:"Longrange"}];break;case S.F.GUN:t=[{name:"Kick",type:"crush",stance:"Aggressive"}];break;case S.F.BULWARK:t=[{name:"Pummel",type:"crush",stance:"Accurate"},{name:"Block",type:null,stance:null}];break;case S.F.PARTISAN:t=[{name:"Stab",type:"stab",stance:"Accurate"},{name:"Lunge",type:"stab",stance:"Aggressive"},{name:"Pound",type:"crush",stance:"Aggressive"},{name:"Block",type:"stab",stance:"Defensive"}];break;case S.F.PICKAXE:t=[{name:"Spike",type:"stab",stance:"Accurate"},{name:"Impale",type:"stab",stance:"Aggressive"},{name:"Smash",type:"crush",stance:"Aggressive"},{name:"Block",type:"stab",stance:"Defensive"}];break;case S.F.POLEARM:t=[{name:"Jab",type:"stab",stance:"Controlled"},{name:"Swipe",type:"slash",stance:"Aggressive"},{name:"Fend",type:"stab",stance:"Defensive"}];break;case S.F.POWERED_STAFF:case S.F.POWERED_WAND:t=[{name:"Accurate",type:"magic",stance:"Accurate"},{name:"Accurate",type:"magic",stance:"Accurate"},{name:"Longrange",type:"magic",stance:"Longrange"}];break;case S.F.SALAMANDER:t=[{name:"Scorch",type:"slash",stance:"Aggressive"},{name:"Flare",type:"ranged",stance:"Rapid"},{name:"Blaze",type:"magic",stance:"Defensive"}];break;case S.F.CHINCHOMPA:t=[{name:"Short fuse",type:"ranged",stance:"Accurate"},{name:"Medium fuse",type:"ranged",stance:"Rapid"},{name:"Long fuse",type:"ranged",stance:"Longrange"}];break;case S.F.CLAW:t=[{name:"Chop",type:"slash",stance:"Accurate"},{name:"Slash",type:"slash",stance:"Aggressive"},{name:"Lunge",type:"stab",stance:"Controlled"},{name:"Block",type:"slash",stance:"Defensive"}];break;case S.F.BLUDGEON:t=[{name:"Pound",type:"crush",stance:"Aggressive"},{name:"Pummel",type:"crush",stance:"Aggressive"},{name:"Smash",type:"crush",stance:"Aggressive"}];break;case S.F.BLUNT:t=[{name:"Pound",type:"crush",stance:"Accurate"},{name:"Pummel",type:"crush",stance:"Aggressive"},{name:"Block",type:"crush",stance:"Defensive"}];break;case S.F.POLESTAFF:t=[{name:"Bash",type:"crush",stance:"Accurate"},{name:"Pound",type:"crush",stance:"Aggressive"},{name:"Block",type:"crush",stance:"Defensive"}];break;case S.F.SPIKED:t=[{name:"Pound",type:"crush",stance:"Accurate"},{name:"Pummel",type:"crush",stance:"Aggressive"},{name:"Spike",type:"stab",stance:"Controlled"},{name:"Block",type:"crush",stance:"Defensive"}];break;case S.F.STAFF:t=[{name:"Bash",type:"crush",stance:"Accurate"},{name:"Pound",type:"crush",stance:"Aggressive"},{name:"Focus",type:"crush",stance:"Defensive"},{name:"Spell",type:"magic",stance:"Defensive Autocast"},{name:"Spell",type:"magic",stance:"Autocast"}];break;case S.F.AXE:t=[{name:"Chop",type:"slash",stance:"Accurate"},{name:"Hack",type:"slash",stance:"Aggressive"},{name:"Smash",type:"crush",stance:"Aggressive"},{name:"Block",type:"slash",stance:"Defensive"}];break;case S.F.NONE:case S.F.UNARMED:t=[{name:"Punch",type:"crush",stance:"Accurate"},{name:"Kick",type:"crush",stance:"Aggressive"},{name:"Block",type:"crush",stance:"Defensive"}];break;case S.F.SCYTHE:t=[{name:"Reap",type:"slash",stance:"Accurate"},{name:"Chop",type:"slash",stance:"Aggressive"},{name:"Jab",type:"crush",stance:"Aggressive"},{name:"Block",type:"slash",stance:"Defensive"}];break;case S.F.SLASH_SWORD:t=[{name:"Chop",type:"slash",stance:"Accurate"},{name:"Slash",type:"slash",stance:"Aggressive"},{name:"Lunge",type:"stab",stance:"Controlled"},{name:"Block",type:"slash",stance:"Defensive"}];break;case S.F.SPEAR:t=[{name:"Lunge",type:"stab",stance:"Controlled"},{name:"Swipe",type:"slash",stance:"Controlled"},{name:"Pound",type:"crush",stance:"Controlled"},{name:"Block",type:"stab",stance:"Defensive"}];break;case S.F.STAB_SWORD:t=[{name:"Stab",type:"stab",stance:"Accurate"},{name:"Lunge",type:"stab",stance:"Aggressive"},{name:"Slash",type:"slash",stance:"Aggressive"},{name:"Block",type:"stab",stance:"Defensive"}];break;case S.F.WHIP:t=[{name:"Flick",type:"slash",stance:"Accurate"},{name:"Lash",type:"slash",stance:"Controlled"},{name:"Deflect",type:"slash",stance:"Defensive"}];break;default:t=[]}return t.push({name:"Spell",type:"magic",stance:"Manual Cast"}),t}},10064:function(e,t,a){"use strict";a.d(t,{l:function(){return r}});var s=a(88017),n=a(58608);let r=async e=>{let{loadouts:t,monster:a,calcOpts:s}=e,r=[];for(let[e,o]of t.entries()){let t=o.name||(e+1).toString(),i=self.performance.now(),c=new n.Z(o,a,{loadoutName:t,detailedOutput:s.detailedOutput,disableMonsterScaling:s.disableMonsterScaling});r.push({ttkDist:c.getTtkDistribution()});let l=self.performance.now();console.debug("TTK Dist ".concat(t," took ").concat(l-i,"ms to calculate"))}return r};self.onmessage=async e=>{console.log("TTK IN ".concat(new Date().toISOString()),e);let t=JSON.parse(e.data,s.og),{type:a,sequenceId:n,data:o}=t,i={type:a,sequenceId:n};try{a===s._Y.COMPUTE_TTK?i.payload=await r(o,t):i.error="Unsupported request type ".concat(a)}catch(e){e instanceof Error?i.error=e.message:i.error="Unknown error type: ".concat(e)}self.postMessage(JSON.stringify(i,s.Wo))}},90885:function(e,t,a){"use strict";var s,n,r,o,i=a(88017),c=a(97431),l=a(17765),u=a(37228),h=a(52686),f=a(58608),d=a(29928),g=a(51182),m=a(27534);class p extends l.Z{getDistribution(){return void 0===this.memoizedDist&&(this.memoizedDist=this.getDistributionImpl()),this.memoizedDist}getPlayerVsNPCCalc(){return void 0===this.memoizedPlayerVsNPCCalc&&(this.memoizedPlayerVsNPCCalc=new f.Z(this.player,this.monster,{loadoutName:"".concat(this.opts.loadoutName,"/forward"),disableMonsterScaling:!0})),this.memoizedPlayerVsNPCCalc}getPlayerDefensiveBonus(){let e=0;switch(this.monster.style){case"crush":e=this.player.defensive.crush;break;case"stab":e=this.player.defensive.stab;break;case"slash":e=this.player.defensive.slash;break;case"magic":e=this.player.defensive.magic;break;case"ranged":e=this.player.defensive.ranged}return e}getDistributionImpl(){let e=this.getHitChance(),t=this.getNPCMaxHit(),a=this.getPlayerDefensiveBonus(),s=u.dA.linear(e,0,t),n=new u.ZE([s]);if(this.wearing("Elysian spirit shield")&&(n=new u.ZE([new u.dA([...s.scaleProbability(.3).hits,...s.scaleProbability(.7).hits.map(e=>new u.q5(e.probability,e.hitsplats.map(e=>{let t=Math.max(1,Math.trunc(e.damage/4));return new u.L_(Math.max(0,e.damage-t),e.accurate)})))])])),this.wearing(["Dinh's bulwark","Dinh's blazing bulwark"])&&"Block"===this.player.style.name&&(n=n.scaleDamage(.8)),this.isWearingJusticiarArmour()){let e=1-a/3e3;n=new u.ZE([new u.dA([...n.dists[0].hits.map(t=>new u.q5(t.probability,t.hitsplats.map(t=>new u.L_(Math.trunc(t.damage*e),t.accurate))))])])}return n}getPlayerDefenceRoll(){let e=this.player.style.stance,t=this.monster.style||"",a=this.player.skills,s=this.player.boosts,n=this.player.prayers.map(e=>g.Fn[e]),r=0;"Defensive"===e&&(r+=3),"Controlled"===e&&(r+=1),"Longrange"===e&&(r+=3);let o=this.getPlayerDefensiveBonus(),i=this.trackAdd(d.L.PLAYER_DEFENCE_ROLL_LEVEL,a.def,s.def),c=(0,m.Z)(n.filter(e=>e.factorDefence),e=>e.factorDefence[0]-100);if(i=this.trackFactor(d.L.PLAYER_DEFENCE_ROLL_LEVEL_PRAYER,i,[c+100,100]),this.isWearingTorags()){let e=a.hp+s.hp,t=Math.round((a.hp-e)/a.hp*100)/100*100;i=this.trackFactor(d.L.PLAYER_DEFENCE_ROLL_LEVEL_TORAGS,i,[1+t,100])}if("magic"===t){let e=this.trackAdd(d.L.PLAYER_DEFENCE_ROLL_MAGIC_LEVEL,a.magic,s.magic);for(let t of n.filter(e=>e.factorDefenceMagic&&"magic"===e.combatStyle))e=this.trackFactor(d.L.PLAYER_DEFENCE_ROLL_MAGIC_LEVEL_PRAYER,e,t.factorDefenceMagic);i=Math.trunc(7*e/10)+Math.trunc(3*i/10)}i=this.trackAdd(d.L.PLAYER_DEFENCE_ROLL_EFFECTIVE_LEVEL,i,r);let l=this.trackAdd(d.L.PLAYER_DEFENCE_ROLL_GEAR_BONUS,o,64);return this.track(d.L.PLAYER_DEFENCE_ROLL_FINAL,(8+i)*l)}getNPCMaxAttackRoll(){let e=this.monster.style||"",t=this.monster.skills,a=this.monster.offensive,s=0,n=0;return["slash","crush","stab"].includes(e)&&(s=this.trackAdd(d.L.NPC_ACCURACY_ROLL_BASE,9,t.atk),n=this.trackAdd(d.L.NPC_ACCURACY_ROLL_BONUS,a.atk,64)),"ranged"===e&&(s=this.trackAdd(d.L.NPC_ACCURACY_ROLL_BASE,9,t.ranged),n=this.trackAdd(d.L.NPC_ACCURACY_ROLL_BONUS,a.ranged,64)),"magic"===e&&(s=this.trackAdd(d.L.NPC_ACCURACY_ROLL_BASE,9,t.magic),n=this.trackAdd(d.L.NPC_ACCURACY_ROLL_BONUS,a.magic,64)),this.track(d.L.NPC_ACCURACY_ROLL_FINAL,s*n)}getNPCMaxHit(){let e=this.monster.style||"",t=this.monster.skills,a=this.monster.offensive,s=this.monster.name,n=-1===this.monster.id,r=0;return["slash","crush","stab"].includes(e)&&(r=Math.trunc(((9+t.str)*(a.str+64)+320)/640)),"ranged"===e&&(r=Math.trunc(((9+t.ranged)*(a.ranged_str+64)+320)/640)),"magic"===e&&(r=Math.trunc(((9+t.magic)*(a.magic_str+64)+320)/640)),Object.prototype.hasOwnProperty.call(h.VN,this.monster.id)?r=h.VN[this.monster.id]:"magic"!==e||void 0===this.monster.maxHit||r===this.monster.maxHit||n||(r=this.monster.maxHit),"Aberrant spectre"===s&&(this.wearing("Nose peg")||this.isWearingSlayerHelmet())&&(r=8),"Dust devil"===s&&(this.wearing("Face mask")||this.isWearingSlayerHelmet())&&(r=8),"Banshee"===s&&(this.wearing("Earmuffs")||this.isWearingSlayerHelmet())&&(r=2),"Wall beast"===s&&(this.wearing("Spiny helmet")||this.isWearingSlayerHelmet())&&(r=4),"Sourhog"===s&&(this.wearing("Reinforced goggles")||this.isWearingSlayerHelmet())&&(r=6),["Ice troll female","Thrower Troll","Thrower troll (Trollheim)"].includes(s)&&this.wearing("Neitiznot shield")&&(r=2),r}getHitChance(){if(h.x8.includes(this.monster.id))return 1;let e=this.getNPCMaxAttackRoll(),t=this.getPlayerDefenceRoll();return l.Z.getNormalAccuracyRoll(e,t)}getDpt(){return this.getDistribution().getExpectedDamage()/this.monster.speed}getDps(){return this.getDpt()/h.P1}getAverageDamageTaken(){let e=this.getPlayerVsNPCCalc().getTtk();return e?e*this.getDps():void 0}constructor(e,t,a={}){super(e,t,a),(0,c._)(this,"memoizedDist",void 0),(0,c._)(this,"memoizedPlayerVsNPCCalc",void 0)}}var A=a(35113),E=a(50641),y=a(7237),L=a(30217),_=a.n(L);(s=r||(r={}))[s.MONSTER_DEF=0]="MONSTER_DEF",s[s.MONSTER_MAGIC=1]="MONSTER_MAGIC",s[s.MONSTER_HP=2]="MONSTER_HP",s[s.PLAYER_ATTACK_LEVEL=3]="PLAYER_ATTACK_LEVEL",s[s.PLAYER_STRENGTH_LEVEL=4]="PLAYER_STRENGTH_LEVEL",s[s.PLAYER_RANGED_LEVEL=5]="PLAYER_RANGED_LEVEL",s[s.PLAYER_MAGIC_LEVEL=6]="PLAYER_MAGIC_LEVEL",s[s.STAT_DECAY_RESTORE=7]="STAT_DECAY_RESTORE",s[s.PLAYER_DEFENCE_LEVEL=8]="PLAYER_DEFENCE_LEVEL",(n=o||(o={}))[n.PLAYER_DPS=0]="PLAYER_DPS",n[n.PLAYER_EXPECTED_HIT=1]="PLAYER_EXPECTED_HIT",n[n.MONSTER_DPS=2]="MONSTER_DPS",n[n.DAMAGE_TAKEN=3]="DAMAGE_TAKEN",n[n.PLAYER_TTK=4]="PLAYER_TTK",n[n.PLAYER_MAX_HIT=5]="PLAYER_MAX_HIT";class M{*inputsIterator(){let e=(e,t)=>({xValue:e,loadouts:this.baseLoadouts,monster:(0,y.Xy)(this.baseMonster,t)}),t=(e,t)=>({xValue:e,loadouts:this.baseLoadouts.map(e=>(0,y.Xy)(e,t)),monster:this.baseMonster}),a=(e,a)=>t(e,{skills:{[a]:e},boosts:{[a]:0}});switch(this.xAxis){case 0:for(let t=this.baseMonster.skills.def;t>=0;t--)yield e(t,{skills:{def:t}});return;case 1:for(let t=this.baseMonster.skills.magic;t>=0;t--)yield e(t,{skills:{magic:t}});return;case 2:for(let e=this.baseMonster.skills.hp;e>=0;e--)yield{xValue:e,loadouts:this.baseLoadouts,monster:(0,A.A)(_()(this.baseMonster,{inputs:{monsterCurrentHp:e}}))};return;case 3:for(let e=0;e<=125;e++)yield a(e,"atk");return;case 4:for(let e=0;e<=125;e++)yield a(e,"str");return;case 8:for(let e=0;e<=125;e++)yield a(e,"def");return;case 5:for(let e=0;e<=125;e++)yield a(e,"ranged");return;case 6:for(let e=0;e<=125;e++)yield a(e,"magic");return;case 7:{let e=(0,E.Z)(this.baseLoadouts,e=>(0,E.Z)((0,y.XP)(e.boosts),t=>Math.abs(e.boosts[t])))||0;for(let t=0;t<=e;t++){let e=this.baseLoadouts.map(e=>{let a={};return(0,y.XP)(e.boosts).forEach(s=>{let n=e.boosts[s],r=Math.abs(n);t>=r?a[s]=0:a[s]=Math.sign(n)*(r-t)}),(0,y.Xy)(e,{boosts:a})});yield{xValue:t,loadouts:e,monster:this.baseMonster}}return}default:throw Error("unimplemented xAxisType ".concat(this.xAxis))}}getOutput(e){let t={},a=a=>e.loadouts.forEach(e=>{t[e.name]=a(e)}),s=t=>new f.Z(t,e.monster,this.commonOpts),n=t=>new p(t,e.monster,this.commonOpts);switch(this.yAxis){case 0:a(e=>s(e).getDps().toFixed(h.IH));break;case 1:a(e=>s(e).getDistribution().getExpectedDamage().toFixed(h.IH));break;case 4:a(e=>{var t;return null===(t=s(e).getTtk())||void 0===t?void 0:t.toFixed(h.IH)});break;case 2:a(e=>n(e).getDps().toFixed(h.IH));break;case 3:a(e=>{var t;return null===(t=n(e).getAverageDamageTaken())||void 0===t?void 0:t.toFixed(h.IH)});break;case 5:a(e=>s(e).getMax().toString());break;default:throw Error("unimplemented yAxisType ".concat(this.yAxis))}return t}getAnnotationsX(){if(0===this.xAxis){let e=[],t=this.baseMonster.skills.def,a=1;for(;t>=100;)t-=Math.trunc(3*t/10),e.push({label:"DWH x".concat(a),value:t}),a+=1;t=this.baseMonster.skills.def;let s=1;for(;t>=100;)t-=Math.trunc(35*t/100),e.push({label:"Elder Maul x".concat(s),value:t}),s+=1;return e}return[]}getAnnotationsY(){return[]}getEntries(){let e=0,t=[];for(let a of this.inputsIterator()){let s=this.getOutput(a);for(let t of(0,y.XP)(s)){let a=s[t]?parseFloat(s[t]):0;a>e&&(e=a)}t.push({...s,name:a.xValue})}return[t,e]}constructor(e,t,a,s){(0,c._)(this,"baseLoadouts",void 0),(0,c._)(this,"baseMonster",void 0),(0,c._)(this,"xAxis",void 0),(0,c._)(this,"yAxis",void 0),(0,c._)(this,"commonOpts",void 0),this.baseLoadouts=e,this.baseMonster=(0,A.B)(t),this.xAxis=a,this.yAxis=s,this.commonOpts={loadoutName:"comparator",disableMonsterScaling:!0}}}var b=a(10064),D=a(78923);let R=async e=>{let{loadouts:t,monster:a,calcOpts:s}=e,n=[];for(let[e,r]of t.entries()){let t=(e+1).toString(),o=self.performance.now(),i=new f.Z(r,a,{loadoutName:t,detailedOutput:s.detailedOutput,disableMonsterScaling:s.disableMonsterScaling}),c=i.getSpecCalc();n.push({npcDefRoll:i.getNPCDefenceRoll(),maxHit:i.getDistribution().getMax(),expectedHit:i.getDistribution().getExpectedDamage(),maxAttackRoll:i.getMaxAttackRoll(),accuracy:i.getDisplayHitChance(),dps:i.getDps(),ttk:i.getTtk(),hitDist:i.getDistribution().asHistogram(s.hitDistHideMisses),details:i.details,userIssues:i.userIssues,specAccuracy:null==c?void 0:c.getDisplayHitChance(),specMaxHit:null==c?void 0:c.getMax(),specExpected:null==c?void 0:c.getExpectedDamage(),specMomentDps:null==c?void 0:c.getDps(),specFullDps:null==c?void 0:c.getSpecDps(),specHitDist:null==c?void 0:c.getDistribution().asHistogram(s.hitDistHideMisses),specDetails:null==c?void 0:c.details});let l=self.performance.now();console.debug("Loadout ".concat(e+1," took ").concat(l-o,"ms to calculate"))}return n},k=async e=>{let{loadouts:t,monster:a,calcOpts:s}=e,n=[];for(let[e,r]of t.entries()){let t=(e+1).toString(),o=self.performance.now(),i=new p(r,a,{loadoutName:"".concat(t,"/reverse"),detailedOutput:s.detailedOutput,disableMonsterScaling:s.disableMonsterScaling});n.push({npcMaxAttackRoll:i.getNPCMaxAttackRoll(),npcMaxHit:i.getDistribution().getMax(),npcDps:i.getDps(),npcAccuracy:i.getHitChance(),playerDefRoll:i.getPlayerDefenceRoll(),avgDmgTaken:i.getAverageDamageTaken(),npcDetails:i.details});let c=self.performance.now();console.debug("Reverse loadout ".concat(e+1," took ").concat(c-o,"ms to calculate"))}return n},P=async e=>{let{axes:t,loadouts:a,monster:s}=e,n=new M(a,s,t.x,t.y),[r,o]=n.getEntries();return{entries:r,annotations:{x:n.getAnnotationsX(),y:n.getAnnotationsY()},domainMax:o}},S=()=>{let e=new y.CR,t=new Worker(a.tu(new URL(a.p+a.u(5434),a.b)));return t.onmessage=a=>{let s=JSON.parse(a.data,i.og);t.terminate(),e.resolve(s)},t.onerror=e=>console.error(e.message,e),{promise:e,worker:t}},C=(0,D.Z)(0,10).map(e=>e<h.Ge?S():void 0),T=1,v=-1,N=async(e,t)=>{let{sequenceId:a}=t,{loadouts:s,monster:n,calcOpts:r}=e;v=a;let o=T*h.Ge;T+=1;let c=(T%=2)*h.Ge;for(let e=0;e<h.Ge;e++){var l,u;null===(u=C[o+e])||void 0===u||null===(l=u.worker)||void 0===l||l.terminate()}let f=self.performance.now(),d=[];for(let e=0;e<s.length;e++){let t=s[e];if(!t)continue;let{promise:o,worker:l}=C[c+e]||(C[c+e]=S());l.postMessage(JSON.stringify({type:i._Y.COMPUTE_TTK,sequenceId:a,data:{loadouts:[t],monster:n,calcOpts:r}})),d.push(o.promise)}for(let e=0;e<h.Ge;e++)C[o+e]=S();let g=await Promise.all(d),m=self.performance.now();if(console.debug("Aggregating ".concat(d.length," TTK dists took ").concat(m-f)),g[0].sequenceId!==v)return console.debug("Dropping ttk parallel ".concat(g[0].sequenceId," as stale")),[];let p=[];for(let[e,{payload:t,error:a}]of g.entries()){if(a)throw Error(a);p[e]=t[0]}return p};self.onmessage=async e=>{let t=JSON.parse(e.data,i.og),{type:a,sequenceId:s,data:n}=t,r={type:a,sequenceId:s};try{switch(a){case i._Y.COMPUTE_BASIC:r.payload=await R(n,t);break;case i._Y.COMPUTE_REVERSE:r.payload=await k(n,t);break;case i._Y.COMPARE:r.payload=await P(n,t);break;case i._Y.COMPUTE_TTK:r.payload=await (0,b.l)(n,t);break;case i._Y.COMPUTE_TTK_PARALLEL:r.payload=await N(n,t);break;default:r.error="Unsupported request type ".concat(a)}}catch(e){e instanceof Error?(console.error(e),r.error=e.message):r.error="Unknown error type: ".concat(e)}self.postMessage(JSON.stringify(r,i.Wo))}}},i={};function c(e){var t=i[e];if(void 0!==t)return t.exports;var a=i[e]={id:e,loaded:!1,exports:{}},s=!0;try{o[e](a,a.exports,c),s=!1}finally{s&&delete i[e]}return a.loaded=!0,a.exports}c.m=o,c.x=function(){var e=c.O(void 0,[9759,9313,506,4315],function(){return c(90885)});return c.O(e)},e=[],c.O=function(t,a,s,n){if(a){n=n||0;for(var r=e.length;r>0&&e[r-1][2]>n;r--)e[r]=e[r-1];e[r]=[a,s,n];return}for(var o=1/0,r=0;r<e.length;r++){for(var a=e[r][0],s=e[r][1],n=e[r][2],i=!0,l=0;l<a.length;l++)o>=n&&Object.keys(c.O).every(function(e){return c.O[e](a[l])})?a.splice(l--,1):(i=!1,n<o&&(o=n));if(i){e.splice(r--,1);var u=s();void 0!==u&&(t=u)}}return t},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,{a:t}),t},c.d=function(e,t){for(var a in t)c.o(t,a)&&!c.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},c.f={},c.e=function(e){return Promise.all(Object.keys(c.f).reduce(function(t,a){return c.f[a](e,t),t},[]))},c.u=function(e){return 9313===e?"static/chunks/9313-161008bdb3060d38.js":506===e?"static/chunks/506-e33c73a32a16ee47.js":"static/chunks/"+e+"."+({4315:"9245d50d9d2b3c9c",5434:"b369e420b94392c4",9759:"9584d912d18a73d4"})[e]+".js"},c.miniCssF=function(e){},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},c.tt=function(){return void 0===t&&(t={createScriptURL:function(e){return e}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(t=trustedTypes.createPolicy("nextjs#bundler",t))),t},c.tu=function(e){return c.tt().createScriptURL(e)},c.p="/_next/",c.b=self.location+"/../../../",a={885:1},c.f.i=function(e,t){a[e]||importScripts(c.tu(c.p+c.u(e)))},n=(s=self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push.bind(s),s.push=function(e){var t=e[0],s=e[1],r=e[2];for(var o in s)c.o(s,o)&&(c.m[o]=s[o]);for(r&&r(c);t.length;)a[t.pop()]=1;n(e)},r=c.x,c.x=function(){return Promise.all([9759,9313,506,4315].map(c.e,c)).then(r)},_N_E=c.x()}();